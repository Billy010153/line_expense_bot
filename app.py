<略：內容與上面一致，已包含 log 與防錯，為節省空間略去>